{% extends "base.html" %}
{% block title %}{{ title }}{% endblock %}

{% block header %}
<link rel="stylesheet" href="//cdn.datatables.net/1.10.8/css/dataTables.bootstrap.min.css">
<link rel="stylesheet" href="//cdn.datatables.net/responsive/1.0.7/css/responsive.dataTables.min.css">
<script src="//cdn.datatables.net/1.10.8/js/jquery.dataTables.min.js"></script>
<script src="//cdn.datatables.net/responsive/1.0.7/js/dataTables.responsive.min.js"></script>
<script src="//cdn.datatables.net/1.10.8/js/dataTables.bootstrap.min.js"></script>
<script src="/static/gene/gene_page.js"></script>
<script language="javascript" type="text/javascript">
$(document).ready(function() {
	$('.panel-body.collapse').each(function(){
		if (localStorage.getItem($(this).attr('name')+'Section')) {
			$(this).collapse('show'); // open sections
		}
	});
	$('.panel-body.collapse').on('shown.bs.collapse', function (e) {
		localStorage.setItem($(this).attr('name')+'Section', 'open');
	});

	$('.panel-body.collapse').on('hidden.bs.collapse', function (e) {
		localStorage.removeItem($(this).attr('name')+'Section');
	});
});
</script>
{% endblock %}

{% block content %}
{% load filter_tags %}{% load gene_tags %}

{% with ngenes=genes|length %}

{% for gene in genes %}
	{% if forloop.counter == 1 or forloop.counter == 3 %}<div class="row">{% endif %}
		<div class="col-md-{% if ngenes > 1 %}6{% else %}12{% endif %}">

			<div class="row">
			<div class="col-md-6">
			<div class="panel panel-info">
			  <div class="panel-heading"><h3 class="panel-title">Gene Summary</a></h3></div>
			  <div class="panel-body">
			
			<table class="table table-striped table-condensed">
				<tr><td>Gene </td><td>{{ gene|doc_attr:"symbol" }}</td></tr>
				<tr><td>Biotype </td><td>{{ gene|doc_attr:"biotype" }}</td></tr>
				<tr><td>Synonyms </td><td>
				{% with synonyms=gene|doc_attr:"synonyms"  %}
					{% for synonym in synonyms %}
						{{ synonym }}; 
					{% endfor %}
				{% endwith %}
				</td></tr>
			
				<tr><td>Location  </td><td>
				{% with loc=gene|doc_attr:"chromosome" %}
					chr{{ loc }}: {{ gene|doc_attr:"start" }}-{{ gene|doc_attr:"stop" }}
				{% endwith %}
				</td></tr>
			</table>
			</div></div>
			</div>
			
			<div class="col-md-6">
			<div class="panel panel-info">
			  <div class="panel-heading"><h3 class="panel-title">External Links</a></h3></div>
			  <div class="panel-body">
			<table class="table table-striped table-condensed">
			{% with dbxrefs=gene|doc_attr:"dbxrefs" %}
			{% for db, accs in dbxrefs.items|sort %}
				{% if db != 'orthologs' %}
				{% with dblink=db|db_link %}
				<tr><td>{{ db|capfirst }}</td><td>
					{% if dblink != "" %}
						{% if accs|is_list %}
							{% for acc in accs %}
								<a data-toggle="tooltip" title="{{ dblink.about }}" href="{{ dblink.link }}{{ acc }}" target="_blank">{{ acc }}</a>&nbsp;
							{% endfor %}
						{% else %}
							<a data-toggle="tooltip" title="{{ dblink.about }}" href="{{ dblink.link }}{{ accs }}" target="_blank">{{ accs }}</a>
						{% endif %}
					{% else %}
						{{ accs }}
					{% endif %}
				</td></tr>
				{% endwith %}
				{% endif %}
			{% endfor %}
			{% endwith %}
			</table>
			</div></div>
			</div>
			</div>
			
			<div class="panel panel-info">
			  <div class="panel-heading"><h3 class="panel-title">Studies
			  <a role="button" data-toggle="collapse" href="#studies-{{ gene|doc_id }}" aria-expanded="false" aria-controls="mappingFilters">
			  <i class="fa fa-caret-square-o-down"></i>
			  </a></h3></div>
			  <div class="panel-body collapse" id="studies-{{ gene|doc_id }}" name="studies">
			    {% show_studies_section gene|doc_id %}
			  </div>
			</div>

			<div class="panel panel-info">
			  <div class="panel-heading"><h3 class="panel-title">Publications
			  <a role="button" data-toggle="collapse" href="#publications-{{ gene|doc_id }}" aria-expanded="false" aria-controls="mappingFilters">
			  <i class="fa fa-caret-square-o-down"></i>
			  </a></h3></div>
			  <div class="panel-body collapse" id="publications-{{ gene|doc_id }}" name="publications">
			    {% show_pub_section gene %}
			  </div>
			</div>
			
			
			<div class="panel panel-info">
			  <div class="panel-heading"><h3 class="panel-title">Interactions
			  <a role="button" data-toggle="collapse" href="#interactions-{{ gene|doc_id }}" aria-expanded="false" aria-controls="mappingFilters">
			  <i class="fa fa-caret-square-o-down"></i>
			  </a></h3></div>
			  <div class="panel-body collapse" id="interactions-{{ gene|doc_id }}" name="interactions">
			    {% show_interactions_section gene|doc_id %}
			  </div>
			</div>
			
			
			<div class="panel panel-info">
			  <div class="panel-heading"><h3 class="panel-title">Pathway Gene Sets
			  <a role="button" data-toggle="collapse" href="#genesets-{{ gene|doc_id }}" aria-expanded="false" aria-controls="mappingFilters">
			  <i class="fa fa-caret-square-o-down"></i>
			  </a></h3></div>
			  <div class="panel-body collapse" id="genesets-{{ gene|doc_id }}" name="genesets">
			    {% show_genesets_section gene|doc_id %}
			  </div>
			</div>
			
			
			<div class="panel panel-info">
			  <div class="panel-heading"><h3 class="panel-title">Model Organism Phenotype Links
			  <a role="button" data-toggle="collapse" href="#phenotype-{{ gene|doc_id }}" aria-expanded="false" aria-controls="mappingFilters">
			  <i class="fa fa-caret-square-o-down"></i>
			  </a></h3></div>
			  <div class="panel-body collapse" id="phenotype-{{ gene|doc_id }}" name="phenotype">
			    {% show_phenotype_section gene|doc_attr:"dbxrefs" %}
			  </div>
			</div>

		</div>
	{% if forloop.counter == 2 or forloop.counter == 4 %}</div>{% endif %}
{% endfor %}

{% endwith %}
{% endblock %}
